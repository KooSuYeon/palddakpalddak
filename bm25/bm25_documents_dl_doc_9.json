[
    {
        "id": null,
        "metadata": {},
        "page_content": "[ìŠ¤íŒŒë¥´íƒ€ì½”ë”©í´ëŸ½] 9. ResNetğŸ“˜[SCC] ê¸°ì´ˆê°€ íƒ„íƒ„í•œ ë”¥ëŸ¬ë‹/ğŸ“š[ìŠ¤íŒŒë¥´íƒ€ì½”ë”©í´ëŸ½] ê¸°ì´ˆê°€ íƒ„íƒ„í•œ ë”¥ëŸ¬ë‹ - 4ì£¼ì°¨/ğŸ“•[ìŠ¤íŒŒë¥´íƒ€ì½”ë”©í´ëŸ½] 9. ResNetMade withğŸ“•[ìŠ¤íŒŒë¥´íƒ€ì½”ë”©í´ëŸ½] 9. ResNet[ìˆ˜ì—… ëª©í‘œ]ë¹„ì „ ëª¨ë¸ì˜ ê¸¸ì„ ì—´ì–´ì¤€ ResNet!ì™œ ì¢‹ì€ ì§€ í•œë²ˆ ì•Œì•„ë´…ì‹œë‹¤[ëª©ì°¨]01. ê°œë…import torch.nn as nn",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "import torch.nn.functional as F",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "class Block(nn.Module):\ndef __init__(self, in_ch, out_ch, stride=1):\nsuper(Block, self).__init__()\n# ì²« ë²ˆì§¸ ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "# ì²« ë²ˆì§¸ ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´\n        self.conv1 = nn.Conv2d(in_ch, out_ch, kernel_size=3, stride=stride, padding=1, bias=False)\n        self.bn1 = nn.BatchNorm2d(out_ch) # ë°°ì¹˜ ì •ê·œí™”\n# ë‘ ë²ˆì§¸ ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "# ë‘ ë²ˆì§¸ ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´\n        self.conv2 = nn.Conv2d(out_ch, out_ch, kernel_size=3, stride=1, padding=1, bias=False)\n        self.bn2 = nn.BatchNorm2d(out_ch) # ë°°ì¹˜ ì •ê·œí™”\n# ì…ë ¥ê³¼ ì¶œë ¥ì˜ ì°¨ì›ì´ ë‹¤ë¥¼ ê²½ìš° shortcut ê²½ë¡œ ì •ì˜",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "self.skip_connection = nn.Sequential()\nif stride != 1 or in_ch != out_ch:\n            self.skip_connection = nn.Sequential(",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "nn.Conv2d(in_ch, out_ch, kernel_size=1, stride=stride, bias=False), # ì°¨ì› ë§ì¶”ê¸° ìœ„í•œ 1x1 ì»¨ë³¼ë£¨ì…˜\n                nn.BatchNorm2d(out_ch) # ë°°ì¹˜ ì •ê·œí™”\n)\ndef forward(self, x):",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "# ì²« ë²ˆì§¸ ì»¨ë³¼ë£¨ì…˜ + ReLU í™œì„±í™” í•¨ìˆ˜\n        output = F.relu(self.bn1(self.conv1(x)))\n# ë‘ ë²ˆì§¸ ì»¨ë³¼ë£¨ì…˜ í›„ ë°°ì¹˜ ì •ê·œí™”\n        output = self.bn2(self.conv2(output))\n# shortcut ê²½ë¡œ ì¶œë ¥ê³¼ í˜„ì¬ ë¸”ë¡ì˜ ì¶œë ¥ ë”í•˜ê¸°",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "output += self.skip_connection(x)\n# ìµœì¢… ReLU í™œì„±í™” í•¨ìˆ˜ ì ìš©\n        output = F.relu(output)\nreturn output",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "# ResNet ëª¨ë¸ ì •ì˜\nclass CustomResNet(nn.Module):\ndef __init__(self, block, layers, num_classes=10):\nsuper(CustomResNet, self).__init__()\n        self.initial_channels = 64 # ì²« ë²ˆì§¸ ë ˆì´ì–´ì˜ ì…ë ¥ ì±„ë„ ìˆ˜ ì •ì˜",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "# ì²« ë²ˆì§¸ ì»¨ë³¼ë£¨ì…˜ ë ˆì´ì–´\n        self.conv1 = nn.Conv2d(3, 64, kernel_size=3, stride=1, padding=1, bias=False)\n        self.bn1 = nn.BatchNorm2d(64) # ë°°ì¹˜ ì •ê·œí™”\n# ResNetì˜ ê° ë ˆì´ì–´ ìƒì„±",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "# ResNetì˜ ê° ë ˆì´ì–´ ìƒì„±\n        self.layer1 = self._create_layer(block, 64, layers[0], stride=1)\n        self.layer2 = self._create_layer(block, 128, layers[1], stride=2)",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "self.layer3 = self._create_layer(block, 256, layers[2], stride=2)\n        self.layer4 = self._create_layer(block, 512, layers[3], stride=2)\n# í‰ê·  í’€ë§ ë ˆì´ì–´",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "# í‰ê·  í’€ë§ ë ˆì´ì–´\n        self.avgpool = nn.AdaptiveAvgPool2d((1, 1))\n# ìµœì¢… ì™„ì „ ì—°ê²° ë ˆì´ì–´\n        self.fc = nn.Linear(512, num_classes)\n# ResNetì˜ ê° ë ˆì´ì–´ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "def _create_layer(self, block, out_ch, num_layers, stride):\n        layer_list = []\n# ì²« ë²ˆì§¸ ë¸”ë¡ì€ strideë¥¼ ë°›ì„ ìˆ˜ ìˆìŒ\n        layer_list.append(block(self.initial_channels, out_ch, stride))",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "self.initial_channels = out_ch  # ë‹¤ìŒ ë¸”ë¡ì„ ìœ„í•´ ì±„ë„ ìˆ˜ ì—…ë°ì´íŠ¸\n# ë‚˜ë¨¸ì§€ ë¸”ë¡ë“¤ì€ ê¸°ë³¸ strideë¥¼ ì‚¬ìš©\nfor _ in range(1, num_layers):\n            layer_list.append(block(out_ch, out_ch))",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "return nn.Sequential(*layer_list)\ndef forward(self, x):\n# ì²« ë²ˆì§¸ ì»¨ë³¼ë£¨ì…˜ + ReLU í™œì„±í™” í•¨ìˆ˜\n        x = F.relu(self.bn1(self.conv1(x)))\n# ê° ë ˆì´ì–´ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ í†µê³¼\n        x = self.layer1(x)\n        x = self.layer2(x)",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "x = self.layer3(x)\n        x = self.layer4(x)\n# í‰ê·  í’€ë§ ë° í…ì„œì˜ ì°¨ì› ì¶•ì†Œ\n        x = self.avgpool(x)\n        x = torch.flatten(x, 1)\n# ìµœì¢… ì™„ì „ ì—°ê²° ë ˆì´ì–´ë¥¼ í†µí•´ í´ë˜ìŠ¤ë³„ ì˜ˆì¸¡ê°’ ì¶œë ¥\n        x = self.fc(x)\nreturn x",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "# Custom ResNet-18 ëª¨ë¸ ìƒì„± (ê° ë ˆì´ì–´ì˜ ë¸”ë¡ ìˆ˜ëŠ” 2ê°œì”©)\nmodel = CustomResNet(Block, [2, 2, 2, 2], num_classes=10)\n\nâ€‹Copyright â“’ TeamSparta All rights reserved.",
        "type": "Document"
    }
]