[
    {
        "id": null,
        "metadata": {},
        "page_content": "[ìŠ¤íŒŒë¥´íƒ€ì½”ë”©í´ëŸ½] 6. ìˆœí™˜ ì‹ ê²½ë§(RNN)ğŸ“˜[SCC] ê¸°ì´ˆê°€ íƒ„íƒ„í•œ ë”¥ëŸ¬ë‹/ğŸ“š[ìŠ¤íŒŒë¥´íƒ€ì½”ë”©í´ëŸ½] ê¸°ì´ˆê°€ íƒ„íƒ„í•œ ë”¥ëŸ¬ë‹ - 2ì£¼ì°¨/ğŸ“•[ìŠ¤íŒŒë¥´íƒ€ì½”ë”©í´ëŸ½] 6. ìˆœí™˜ ì‹ ê²½ë§(RNN)Made withğŸ“•[ìŠ¤íŒŒë¥´íƒ€ì½”ë”©í´ëŸ½] 6. ìˆœí™˜ ì‹ ê²½ë§(RNN)[ìˆ˜ì—… ëª©í‘œ]ìˆœí™˜ ì‹ ê²½ë§(RNN) ê°œë…ì— ëŒ€í•´ì„œ ë°°ì›Œë³´ê³  ì–´ë–¤ ì›ë¦¬ë¡œ ë™ì‘í•˜ëŠ”ì§€ ì•Œì•„ë´…ì‹œë‹¤Pytorchë¡œ ê°„ë‹¨í•œ",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "ì•Œì•„ë´…ì‹œë‹¤Pytorchë¡œ ê°„ë‹¨í•œ RNN ëª¨ë¸ êµ¬í˜„ ì‹¤ìŠµì„ ì§„í–‰í•´ ë´…ì‹œë‹¤[ëª©ì°¨]01. RNNì˜ ê¸°ë³¸ êµ¬ì¡°ì™€ ë™ì‘ ì›ë¦¬02. RNNê³¼ LSTMì„ ì´ìš©í•œ ì‹œê³„ì—´ ë°ì´í„° ì˜ˆì¸¡ (PyTorch)import torch.nn as nn",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "import torch.optim as optim\nimport numpy as np\nimport matplotlib.pyplot as plt\nâ€‹â˜‘ï¸ë°ì´í„°ì…‹ ìƒì„± ë° ì „ì²˜ë¦¬ë°ì´í„°ì…‹ ìƒì„± ë° ì „ì²˜ë¦¬ {5px}ë°ì´í„°ì…‹ ìƒì„± ë° ì „ì²˜ë¦¬ ï»¿â€‹PythonCopy# Sine íŒŒí˜• ë°ì´í„° ìƒì„±",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "def create_sine_wave_data(seq_length, num_samples):\n    X = []\n    y = []\nfor _ in range(num_samples):\n        start = np.random.rand()\n        x = np.linspace(start, start + 2 * np.pi, seq_length)",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "X.append(np.sin(x))\n        y.append(np.sin(x + 0.1))\nreturn np.array(X), np.array(y)",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "seq_length = 50\nnum_samples = 1000\nX, y = create_sine_wave_data(seq_length, num_samples)\n# ë°ì´í„°ì…‹ì„ PyTorch í…ì„œë¡œ ë³€í™˜\nX = torch.tensor(X, dtype=torch.float32).unsqueeze(-1)",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "y = torch.tensor(y, dtype=torch.float32).unsqueeze(-1)\nâ€‹â˜‘ï¸ ê°„ë‹¨í•œ RNN ëª¨ë¸ ì •ì˜ê°„ë‹¨í•œ RNN ëª¨ë¸ ì •ì˜ {5px}ê°„ë‹¨í•œ RNN ëª¨ë¸ ì •ì˜ ï»¿â€‹PythonCopyclass SimpleRNN(nn.Module):",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "def __init__(self, input_size, hidden_size, output_size):\nsuper(SimpleRNN, self).__init__()\n        self.rnn = nn.RNN(input_size, hidden_size, batch_first=True)",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "self.fc = nn.Linear(hidden_size, output_size)\ndef forward(self, x):\n        h0 = torch.zeros(1, x.size(0), hidden_size) # ì´ˆê¸° ì€ë‹‰ ìƒíƒœ\n        out, _ = self.rnn(x, h0)",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "out = self.fc(out[:, -1, :]) # ë§ˆì§€ë§‰ ì‹œê°„ ë‹¨ê³„ì˜ ì¶œë ¥\nreturn out",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "input_size = 1\nhidden_size = 32\noutput_size = 1\nmodel = SimpleRNN(input_size, hidden_size, output_size)",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "â€‹nn.RNN: ìˆœí™˜ ì‹ ê²½ë§(RNN) ì¸µì„ ì •ì˜í•©ë‹ˆë‹¤.nn.RNN(input_size, hidden_size, batch_first)ëŠ” ì…ë ¥ í¬ê¸°, ì€ë‹‰ ìƒíƒœ í¬ê¸°, ë°°ì¹˜ ì°¨ì›ì„ ì²« ë²ˆì§¸ë¡œ ì„¤ì •í•©ë‹ˆë‹¤..RNN(input_size, hidden_size, batch_first)ëŠ” ì…ë ¥ í¬ê¸°, ì€ë‹‰ ìƒíƒœ í¬ê¸°, ë°°ì¹˜ ì°¨ì›ì„ ì²« ë²ˆì§¸ë¡œ",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "ìƒíƒœ í¬ê¸°, ë°°ì¹˜ ì°¨ì›ì„ ì²« ë²ˆì§¸ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.ï»¿â€‹nn.Linear: ì„ í˜• ë³€í™˜ì„ ì ìš©í•˜ëŠ” ì™„ì „ ì—°ê²°(fully connected) ë ˆì´ì–´ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.nn.Linear(in_features, out_features)ëŠ” ì…ë ¥ íŠ¹ì§•ì˜ ìˆ˜ì™€ ì¶œë ¥ íŠ¹ì§•ì˜ ìˆ˜ë¥¼ ì§€ì •í•©ë‹ˆë‹¤..Linear(in_features, out_features)ëŠ” ì…ë ¥ íŠ¹ì§•ì˜ ìˆ˜ì™€ ì¶œë ¥",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "ì…ë ¥ íŠ¹ì§•ì˜ ìˆ˜ì™€ ì¶œë ¥ íŠ¹ì§•ì˜ ìˆ˜ë¥¼ ì§€ì •í•©ë‹ˆë‹¤.ï»¿â€‹â˜‘ï¸ ê°„ë‹¨í•œ LSTM ëª¨ë¸ ì •ì˜ê°„ë‹¨í•œ LSTM ëª¨ë¸ ì •ì˜ {5px}ê°„ë‹¨í•œ LSTM ëª¨ë¸ ì •ì˜ ï»¿â€‹PythonCopyclass SimpleLSTM(nn.Module):",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "def __init__(self, input_size, hidden_size, output_size):\nsuper(SimpleLSTM, self).__init__()\n        self.lstm = nn.LSTM(input_size, hidden_size, batch_first=True)",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "self.fc = nn.Linear(hidden_size, output_size)\ndef forward(self, x):\n        h0 = torch.zeros(1, x.size(0), hidden_size) # ì´ˆê¸° ì€ë‹‰ ìƒíƒœ",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "c0 = torch.zeros(1, x.size(0), hidden_size) # ì´ˆê¸° ì…€ ìƒíƒœ\n        out, _ = self.lstm(x, (h0, c0))\n        out = self.fc(out[:, -1, :]) # ë§ˆì§€ë§‰ ì‹œê°„ ë‹¨ê³„ì˜ ì¶œë ¥\nreturn out",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "model = SimpleLSTM(input_size, hidden_size, output_size)",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "â€‹nn.LSTM: ì¥ë‹¨ê¸° ë©”ëª¨ë¦¬(LSTM) ì¸µì„ ì •ì˜í•©ë‹ˆë‹¤.nn.LSTM(input_size, hidden_size, batch_first)ëŠ” ì…ë ¥ í¬ê¸°, ì€ë‹‰ ìƒíƒœ í¬ê¸°, ë°°ì¹˜ ì°¨ì›ì„ ì²« ë²ˆì§¸ë¡œ ì„¤ì •í•©ë‹ˆë‹¤..LSTM(input_size, hidden_size, batch_first)ëŠ” ì…ë ¥ í¬ê¸°, ì€ë‹‰ ìƒíƒœ í¬ê¸°, ë°°ì¹˜ ì°¨ì›ì„ ì²« ë²ˆì§¸ë¡œ",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "ìƒíƒœ í¬ê¸°, ë°°ì¹˜ ì°¨ì›ì„ ì²« ë²ˆì§¸ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.ï»¿â€‹â˜‘ï¸ ëª¨ë¸ í•™ìŠµëª¨ë¸ í•™ìŠµ {5px}ëª¨ë¸ í•™ìŠµ ï»¿â€‹PythonCopy# ì†ì‹¤ í•¨ìˆ˜ì™€ ìµœì í™” ì•Œê³ ë¦¬ì¦˜ ì •ì˜",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "criterion = nn.MSELoss()\noptimizer = optim.Adam(model.parameters(), lr=0.01)\n# ëª¨ë¸ í•™ìŠµ\nnum_epochs = 100\nfor epoch in range(num_epochs):\n    outputs = model(X)\n    optimizer.zero_grad()",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "loss = criterion(outputs, y)\n    loss.backward()\n    optimizer.step()\nif (epoch + 1) % 10 == 0:\nprint(f'Epoch [{epoch + 1}/{num_epochs}], Loss: {loss.item():.4f}')\nprint('Finished Training')",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "â€‹nn.MSELoss: í‰ê·  ì œê³± ì˜¤ì°¨(MSE) ì†ì‹¤ í•¨ìˆ˜ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.optim.Adam: Adam ìµœì í™” ì•Œê³ ë¦¬ì¦˜ì„ ì •ì˜í•©ë‹ˆë‹¤. lrì€ í•™ìŠµë¥ ì„ ì§€ì •í•©ë‹ˆë‹¤.optimizer.zero_grad(): ì´ì „ ë‹¨ê³„ì—ì„œ ê³„ì‚°ëœ ê¸°ìš¸ê¸°ë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.loss.backward(): ì—­ì „íŒŒë¥¼ í†µí•´ ê¸°ìš¸ê¸°ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.optimizer.step(): ê³„ì‚°ëœ ê¸°ìš¸ê¸°ë¥¼",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "ê³„ì‚°ëœ ê¸°ìš¸ê¸°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê°€ì¤‘ì¹˜ë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.â˜‘ï¸ ëª¨ë¸ í‰ê°€ ë° ì‹œê°í™”ëª¨ë¸ í‰ê°€ ë° ì‹œê°í™” {5px}ëª¨ë¸ í‰ê°€ ë° ì‹œê°í™” ï»¿â€‹PythonCopy# ëª¨ë¸ í‰ê°€",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "model.eval()\nwith torch.no_grad():\n    predicted = model(X).detach().numpy()\n# ì‹œê°í™”\nplt.figure(figsize=(10, 5))\nplt.plot(y.numpy().flatten(), label='True')",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "plt.plot(predicted.flatten(), label='Predicted')\nplt.legend()\nplt.show()",
        "type": "Document"
    },
    {
        "id": null,
        "metadata": {},
        "page_content": "plt.show()\nâ€‹model.eval(): ëª¨ë¸ì„ í‰ê°€ ëª¨ë“œë¡œ ì „í™˜í•©ë‹ˆë‹¤.torch.no_grad(): í‰ê°€ ë‹¨ê³„ì—ì„œëŠ” ê¸°ìš¸ê¸°ë¥¼ ê³„ì‚°í•  í•„ìš”ê°€ ì—†ìœ¼ë¯€ë¡œ, ì´ë¥¼ ë¹„í™œì„±í™”í•˜ì—¬ ë©”ëª¨ë¦¬ ì‚¬ìš©ì„ ì¤„ì…ë‹ˆë‹¤.detach(): í…ì„œë¥¼ ê³„ì‚° ê·¸ë˜í”„ì—ì„œ ë¶„ë¦¬í•©ë‹ˆë‹¤.Copyright â“’ TeamSparta All rights reserved.",
        "type": "Document"
    }
]