21강 앙상블 학습  랜덤 포레스트SCC 바닥부터 시작하는 머신러닝 바닥부터 시작하는 머신러닝  5주차 21강 앙상블 학습  랜덤 포레스트제작 21강 앙상블 학습  랜덤 포레스트수업 목표앙상블 학습의 랜덤포레스트에 대한 개념을 배우고 데이터를 이용해 실습해 봅니다목차01 랜덤 포레스트02랜덤 포레스트 모델 구현 및 평가 01 랜덤 포레스트앙상블 기법 중 하나인 랜덤 포레스트에 대해 배워봅시다1 랜덤 포레스트 랜덤 포레스트란랜덤 포레스트Random Forest는 배깅Bagging 기법을 기반으로 한 앙상블 학습 모델입니다여러 개의 결정 트리Decision Tree를 학습시키고 그 예측 결과를 결합하여 최종 예측을 수행합니다 각 트리가 독립적으로 학습되기 때문에 과적합을 방지하고 예측 성능을 향상시킬 수 있습니다ALT 랜덤 포레스트의 구조랜덤 포레스트는 여러 개의 결정 트리로 구성됩니다각 결정 트리는 데이터의 무작위 샘플을 사용하여 학습되며 트리의 예측 결과를 평균 또는 다수결로 결합하여 최종 예측을 수행합니다 랜덤 포레스트의 원리부트스트랩 샘플링 원본 데이터셋에서 중복을 허용한 무작위 샘플을 생성합니다결정 트리 학습 각 부트스트랩 샘플을 사용하여 결정 트리를 학습시킵니다 이때 각 노드에서 무작위로 선택된 특성의 일부만을 사용하여 분할을 수행합니다예측 결합 모든 결정 트리의 예측 결과를 결합하여 최종 예측을 수행합니다 회귀 문제에서는 평균을 사용하고 분류 문제에서는 다수결을 사용합니다 무작위성랜덤 포레스트는 두 가지 무작위성을 도입하여 모델의 다양성을 증가시키고 과적합을 방지합니다데이터 샘플링의 무작위성 각 결정 트리는 원본 데이터셋에서 무작위로 샘플링된 데이터로 학습됩니다특성 선택의 무작위성 각 노드에서 분할을 수행할 때 무작위로 선택된 특성의 일부만을 사용합니다이러한 무작위성은 모델의 상관성을 줄이고 예측 성능을 향상시킵니다02랜덤 포레스트 모델 구현 및 평가유방암 데이터셋을 이용하여 랜덤포레스트를 구현하고 평가하는 실습을 합니다1 유방암 데이터셋 데이터 로드 자동차 수요예측 데이터셋 로드 989C9E자동차 수요예측 데이터셋 로드 EAE9FE260px5px자동차 수요예측 데이터셋 로드 Python복사from sklearnensemble import BaggingRegressor from sklearntree import DecisionTreeRegressor from sklearnmetrics import mean_squared_error from sklearndatasets import load_breast_cancer from sklearnmodel_selection import train_test_split from sklearnpreprocessing import StandardScaler  유방암 데이터 로드 cancer_data  load_breast_cancer X y  cancer_datadata cancer_datatarget  데이터 분할 X_train X_test y_train y_test  train_test_splitX y test_size02 random_state42  데이터 스케일링 scaler  StandardScaler X_train_scaled  scalerfit_transformX_train X_test_scaled  scalertransformX_test  랜덤 포레스트 모델 구현 및 평가Scikitlearn의 RandomForestRegressor를 사용하여 랜덤 포레스트 모델을 구현하고 평가합니다랜덤 포레스트 모델 구현 및 평가 989C9E랜덤 포레스트 모델 구현 및 평가 EAE9FE258px5px랜덤 포레스트 모델 구현 및 평가 Python복사from sklearnensemble import RandomForestRegressor from sklearnmetrics import mean_squared_error  랜덤 포레스트 모델 생성 rf_model  RandomForestRegressorn_estimators100 random_state42  모델 학습 rf_modelfitX_train_scaled y_train  예측 y_pred_rf  rf_modelpredictX_test_scaled  평가 mse_rf  mean_squared_errory_test y_pred_rf printf랜덤 포레스트 모델의 MSE mse_rf  중요 특성 확인중요 특성 확인 989C9E중요 특성 확인 EAE9FE306px5px중요 특성 확인 Python복사import matplotlibpyplot as plt import seaborn as sns  특성 중요도 추출 feature_importances  rf_modelfeature_importances_  특성 중요도를 데이터프레임으로 변환 feature_importances_df  pdDataFrame Feature Xcolumns Importance feature_importances   중요도 순으로 정렬 feature_importances_df  feature_importances_dfsort_valuesbyImportance ascendingFalse  특성 중요도 시각화 pltfigurefigsize10 7 snsbarplotxImportance yFeature datafeature_importances_df plttitleFeature Importances in Random Forest pltshow