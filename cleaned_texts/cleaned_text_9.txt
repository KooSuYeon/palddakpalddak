9강 지도학습  분류모델  로지스틱 회귀SCC 바닥부터 시작하는 머신러닝 바닥부터 시작하는 머신러닝  3주차 9강 지도학습  분류모델  로지스틱 회귀제작 9강 지도학습  분류모델  로지스틱 회귀수업 목표지도학습  분류모델의 로지스틱 회귀에 대해 알아보고 실습을 통해 배워봅시다목차01 로지스틱 회귀 개념02 로지스틱 회귀분석 실습 01 로지스틱 회귀 개념로지스틱 회귀란 무엇인지 왜 사용하는지 배워봅시다1 로지스틱 회귀 로지스틱 회귀란종속 변수가 이진형일 때즉 결과가 두 가지 중 하나일 때 사용되는 통계 기법로지스틱 회귀는 선형 회귀와 달리 결과값이 0과 1 사이에 위치하게 하기 위해 시그모이드 함수Sigmoid Function를 사용합니다로지스틱 회귀는 회귀 분석이지만 실제로는 분류 작업에 사용됩니다로지스틱 회귀는 회귀 분석이지만 실제로는 red분류black 작업에 사용됩니다로지스틱 회귀는 회귀 분석이지만 실제로는 분류 작업에 사용됩니다 시그모이드 함수시그모이드 함수는 로지스틱 회귀의 핵심으로 입력값을 0과 1사이의 값으로 변환합니다σz11ezz  11  ez σz1ez1여기서 z 는 선형 회귀 방정식zβ0β1x1β2x2βnxn입니다여기서 z 는 선형 회귀 방정식z  _0  _1x_1  _2x_2   _nx_n 입니다여기서 z 는 선형 회귀 방정식zβ0β1x1β2x2βnxn입니다 로지스틱 회귀의 목적로지스틱 회귀는 데이터를 학습하여 각 데이터 포인트가 특정 클래스에 속할 확률을 예측합니다예를 들어 유방암 데이터에서는 환자가 암에 걸렸을 확률 타이타닉 데이터 에서는 승객이 생존할 확률을 예측합니다 비용 함수로지스틱 회귀의 비용 함수는 모델의 예측 확률과 실제 레이블 사이의 차이를 측정합니다로그 손실 함수Log Loss 또는 크로스 엔트로피 손실 함수CrossEntropy loss라고 불립니다Jθ1mi1myiloghθxi1yilog1hθxiJ  1m _i1m  yi h_xi  1  yi 1  h_xi Jθm1i1myiloghθxi1yilog1hθxi02 로지스틱 회귀분석 실습Scikitlearn의 유방암데이터와 Seaborn의 타이타닉 데이터로 로지스틱 회귀분석 실습을 진행합니다1 유방암 데이터 데이터 로드 및 전처리유방암 데이터 로드 및 전처리 989C9E유방암 데이터 로드 및 전처리 EAE9FE265px5px유방암 데이터 로드 및 전처리 Python복사import numpy as np import pandas as pd from sklearndatasets import load_breast_cancer from sklearnmodel_selection import train_test_split from sklearnpreprocessing import StandardScaler  데이터 로드 data  load_breast_cancer X  datadata y  datatarget  데이터 분할 X_train X_test y_train y_test  train_test_splitX y test_size02 random_state42  데이터 스케일링 scaler  StandardScaler X_train  scalerfit_transformX_train X_test  scalertransformX_test sklearndatasetsload_breast_cancer 유방암 데이터셋 로드return_X_yFalse 데이터와 타겟을 함께 반환할지 여부 기본값은 False입니다return_X_yFalse 데이터와 타겟을 함께 반환할지 여부 기본값은 False입니다return_X_yFalse 데이터와 타겟을 함께 반환할지 여부 기본값은 False입니다sklearnmodel_selectiontrain_test_split 데이터를 훈련 세트 테스트 세트로 분할test_size02 테스트 세트의 비율을 02로 설정합니다test_size02 테스트 세트의 비율을 02로 설정합니다test_size02 테스트 세트의 비율을 02로 설정합니다random_state42 랜덤 시드 값으로 데이터 분할의 재현성을 위해 사용됩니다random_state42 랜덤 시드 값으로 데이터 분할의 재현성을 위해 사용됩니다random_state42 랜덤 시드 값으로 데이터 분할의 재현성을 위해 사용됩니다sklearnpreprocessingStandardScaler 데이터의 평균을 0 분산을 1로 스케일링fit_transformX_train 훈련 세트를 스케일링하고 변환합니다fit_transformX_train 훈련 세트를 스케일링하고 변환합니다fit_transformX_train 훈련 세트를 스케일링하고 변환합니다transformX_test 테스트 세트를 변환합니다transformX_test 테스트 세트를 변환합니다transformX_test 테스트 세트를 변환합니다 모델 학습모델 학습 989C9E모델 학습 EAE9FE320px5px모델 학습 Python복사from sklearnlinear_model import LogisticRegression from sklearnmetrics import accuracy_score classification_report confusion_matrix  모델 생성 및 학습 model  LogisticRegression modelfitX_train y_train  예측 y_pred  modelpredictX_test  평가 printfAccuracy accuracy_scorey_test y_pred printfClassification Reportclassification_reporty_test y_pred printfConfusion Matrixconfusion_matrixy_test y_pred sklearnlinear_modelLogisticRegression 로지스틱 회귀 모델 생성fitX_train y_train 모델을 훈련 세트에 맞추어 학습시킵니다fitX_train y_train 모델을 훈련 세트에 맞추어 학습시킵니다fitX_train y_train 모델을 훈련 세트에 맞추어 학습시킵니다predictX_test 테스트 세트에 대해 예측을 수행합니다predictX_test 테스트 세트에 대해 예측을 수행합니다predictX_test 테스트 세트에 대해 예측을 수행합니다sklearnmetricsaccuracy_score 정확도 계산accuracy_scorey_test y_pred 실제 값과 예측 값을 비교하여 정확도를 반환합니다accuracy_scorey_test y_pred 실제 값과 예측 값을 비교하여 정확도를 반환합니다accuracy_scorey_test y_pred 실제 값과 예측 값을 비교하여 정확도를 반환합니다sklearnmetricsclassification_report 분류 보고서 생성classification_reporty_test y_pred 정확도 정밀도 재현율 등의 메트릭을 포함한 보고서를 출력합니다classification_reporty_test y_pred 정확도 정밀도 재현율 등의 메트릭을 포함한 보고서를 출력합니다classification_reporty_test y_pred 정확도 정밀도 재현율 등의 메트릭을 포함한 보고서를 출력합니다sklearnmetricsconfusion_matrix 혼동 행렬 생성confusion_matrixy_test y_pred 실제 값과 예측 값의 혼동 행렬을 반환합니다confusion_matrixy_test y_pred 실제 값과 예측 값의 혼동 행렬을 반환합니다confusion_matrixy_test y_pred 실제 값과 예측 값의 혼동 행렬을 반환합니다2 타이타닉 데이터 데이터 로드 및 전처리타이타닉 데이터 로드 및 전처리 989C9E타이타닉 데이터 로드 및 전처리 EAE9FE260px5px타이타닉 데이터 로드 및 전처리 Python복사import seaborn as sns  데이터 로드 titanic  snsload_datasettitanic  필요한 열 선택 및 결측값 처리 titanic  titanicsurvived pclass sex age sibsp parch fare embarkeddropna  성별과 탑승한 곳 인코딩 titanicsex  titanicsexmapmale 0 female 1 titanicembarked  titanicembarkedmapC 0 Q 1 S 2  특성과 타겟 분리 X  titanicdropsurvived axis1 y  titanicsurvived  데이터 분할 X_train X_test y_train y_test  train_test_splitX y test_size02 random_state42  데이터 스케일링 scaler  StandardScaler X_train  scalerfit_transformX_train X_test  scalertransformX_test seabornload_dataset seaborn의 내장 데이터셋 로드titanic 타이타닉 데이터셋을 로드합니다titanic 타이타닉 데이터셋을 로드합니다titanic 타이타닉 데이터셋을 로드합니다 pandasDataFramedropna 결측값이 있는 행 제거pandasDataFramemap 데이터 값을 다른 값으로 매핑male 0 female 1 성별을 숫자로 매핑합니다male 0 female 1 성별을 숫자로 매핑합니다male 0 female 1 성별을 숫자로 매핑합니다C 0 Q 1 S 2 탑승한 곳을 숫자로 매핑합니다C 0 Q 1 S 2 탑승한 곳을 숫자로 매핑합니다C 0 Q 1 S 2 탑승한 곳을 숫자로 매핑합니다 모델 학습모델 학습 989C9E모델 학습 EAE9FE320px5px모델 학습 Python복사 모델 생성 및 학습 model  LogisticRegression modelfitX_train y_train  예측 y_pred  modelpredictX_test  평가 printfAccuracy accuracy_scorey_test y_pred printfClassification Reportclassification_reporty_test y_pred printfConfusion Matrixconfusion_matrixy_test y_pred