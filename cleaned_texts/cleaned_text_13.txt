13강 지도학습  분류모델  의사결정나무SCC 바닥부터 시작하는 머신러닝 바닥부터 시작하는 머신러닝  3주차 13강 지도학습  분류모델  의사결정나무제작 13강 지도학습  분류모델  의사결정나무수업 목표분류모델중 의사결정나무에 대한 개념을 배우고 데이터를 이용해 실습해 봅니다목차01 의사결정나무 개념02 의사결정나무 실습 01 의사결정나무 개념지도학습분류모델의 의사결정나무가 무엇인지 알아봅시다1 의사결정나무 의사결정나무란의사결정나무Decision Tree는 예측 모델 중 하나로 데이터의 특징feature을 기준으로 의사결정 규칙을 만들고 이를 바탕으로 데이터를 분류하거나 회귀하는 데 사용됩니다의사결정나무는 트리 구조를 가지며 각 내부 노드는 데이터의 특정 특징에 대한 테스트를 나타내고 각 가지branch는 테스트 결과를 나타내며 각 리프 노드leaf는 클래스 레이블을 나타냅니다ALT노드 트리의 각 분기점으로 하나의 특징feature에 대한 테스트를 나타냅니다노드 트리의 각 분기점으로 하나의 특징feature에 대한 테스트를 나타냅니다노드 트리의 각 분기점으로 하나의 특징feature에 대한 테스트를 나타냅니다루트 노드 트리의 최상위 노드로 전체 데이터셋을 나타냅니다루트 노드 트리의 최상위 노드로 전체 데이터셋을 나타냅니다루트 노드 트리의 최상위 노드로 전체 데이터셋을 나타냅니다리프 노드 트리의 끝 노드로 최종 클래스 레이블을 나타냅니다리프 노드 트리의 끝 노드로 최종 클래스 레이블을 나타냅니다리프 노드 트리의 끝 노드로 최종 클래스 레이블을 나타냅니다깊이 트리의 루트 노드부터 리프 노드까지의 최대 거리입니다깊이 트리의 루트 노드부터 리프 노드까지의 최대 거리입니다깊이 트리의 루트 노드부터 리프 노드까지의 최대 거리입니다분할 기준 노드를 나눌 때 사용하는 기준으로 정보 이득Information Gain 지니 계수Gini Index 등이 있습니다분할 기준 노드를 나눌 때 사용하는 기준으로 정보 이득Information Gain 지니 계수Gini Index 등이 있습니다분할 기준 노드를 나눌 때 사용하는 기준으로 정보 이득Information Gain 지니 계수Gini Index 등이 있습니다 분할기준정보 이득Information Gain  엔트로피Entropy값으로 데이터를 나누는 기준입니다 엔트로피는 불확실성을 나타내며 엔트로피가 낮을수록 불확실성이 적습니다Information GainDAEntropyDvvaluesADvDEntropyDvInformation GainD A  EntropyD  _v valuesA D_vD EntropyD_vInformation GainDAEntropyDvvaluesADDvEntropyDv지니 계수Gini Index 불순도를 측정하는 방법으로 지니 계수가 낮을수록 불순도가 적습니다GiniD1i1Cpi2GiniD  1  _i1C p_i2GiniD1i1Cpi2여기서 pi는 클래스 i의 비율입니다여기서  p_i 는 클래스  i 의 비율입니다여기서 pi는 클래스 i의 비율입니다02 의사결정나무 실습Scikitlearn의 유방암데이터와 Seaborn의 타이타닉 데이터로 의사결정나무 실습을 진행합니다1 유방암 데이터 데이터 로드 및 전처리유방암 데이터 로드 및 전처리 989C9E유방암 데이터 로드 및 전처리 EAE9FE265px5px유방암 데이터 로드 및 전처리 Python복사import numpy as np import pandas as pd from sklearndatasets import load_breast_cancer from sklearnmodel_selection import train_test_split from sklearnpreprocessing import StandardScaler  데이터 로드 data  load_breast_cancer X  datadata y  datatarget  데이터 분할 X_train X_test y_train y_test  train_test_splitX y test_size02 random_state42  데이터 스케일링 scaler  StandardScaler X_train  scalerfit_transformX_train X_test  scalertransformX_test sklearndatasetsload_breast_cancer 유방암 데이터셋 로드return_X_yFalse 데이터와 타겟을 함께 반환할지 여부 기본값은 False입니다return_X_yFalse 데이터와 타겟을 함께 반환할지 여부 기본값은 False입니다return_X_yFalse 데이터와 타겟을 함께 반환할지 여부 기본값은 False입니다sklearnmodel_selectiontrain_test_split 데이터를 훈련 세트 테스트 세트로 분할test_size02 테스트 세트의 비율을 02로 설정합니다test_size02 테스트 세트의 비율을 02로 설정합니다test_size02 테스트 세트의 비율을 02로 설정합니다random_state42 랜덤 시드 값으로 데이터 분할의 재현성을 위해 사용됩니다random_state42 랜덤 시드 값으로 데이터 분할의 재현성을 위해 사용됩니다random_state42 랜덤 시드 값으로 데이터 분할의 재현성을 위해 사용됩니다sklearnpreprocessingStandardScaler 데이터의 평균을 0 분산을 1로 스케일링fit_transformX_train 훈련 세트를 스케일링하고 변환합니다fit_transformX_train 훈련 세트를 스케일링하고 변환합니다fit_transformX_train 훈련 세트를 스케일링하고 변환합니다transformX_test 테스트 세트를 변환합니다transformX_test 테스트 세트를 변환합니다transformX_test 테스트 세트를 변환합니다 모델 학습모델 학습 989C9E모델 학습 EAE9FE320px5px모델 학습 Python복사from sklearntree import DecisionTreeClassifier from sklearnmetrics import accuracy_score classification_report confusion_matrix  모델 생성 및 학습 model  DecisionTreeClassifierrandom_state42 modelfitX_train y_train  예측 y_pred  modelpredictX_test  평가 printfAccuracy accuracy_scorey_test y_pred printfClassification Reportclassification_reporty_test y_pred printfConfusion Matrixconfusion_matrixy_test y_pred sklearntreeDecisionTreeClassifier 의사결정나무 분류 모델 생성random_state42 랜덤 시드 값으로 트리의 재현성을 위해 사용됩니다random_state42 랜덤 시드 값으로 트리의 재현성을 위해 사용됩니다random_state42 랜덤 시드 값으로 트리의 재현성을 위해 사용됩니다fitX_train y_train 모델을 훈련 세트에 맞추어 학습시킵니다fitX_train y_train 모델을 훈련 세트에 맞추어 학습시킵니다fitX_train y_train 모델을 훈련 세트에 맞추어 학습시킵니다predictX_test 테스트 세트에 대해 예측을 수행합니다predictX_test 테스트 세트에 대해 예측을 수행합니다predictX_test 테스트 세트에 대해 예측을 수행합니다sklearnmetricsaccuracy_score 정확도 계산accuracy_scorey_test y_pred 실제 값과 예측 값을 비교하여 정확도를 반환합니다accuracy_scorey_test y_pred 실제 값과 예측 값을 비교하여 정확도를 반환합니다accuracy_scorey_test y_pred 실제 값과 예측 값을 비교하여 정확도를 반환합니다sklearnmetricsclassification_report 분류 보고서 생성classification_reporty_test y_pred 정확도 정밀도 재현율 등의 메트릭을 포함한 보고서를 출력합니다classification_reporty_test y_pred 정확도 정밀도 재현율 등의 메트릭을 포함한 보고서를 출력합니다classification_reporty_test y_pred 정확도 정밀도 재현율 등의 메트릭을 포함한 보고서를 출력합니다sklearnmetricsconfusion_matrix 혼동 행렬 생성confusion_matrixy_test y_pred 실제 값과 예측 값의 혼동 행렬을 반환합니다confusion_matrixy_test y_pred 실제 값과 예측 값의 혼동 행렬을 반환합니다confusion_matrixy_test y_pred 실제 값과 예측 값의 혼동 행렬을 반환합니다2 타이타닉 데이터 데이터 로드 및 전처리타이타닉 데이터 로드 및 전처리 989C9E타이타닉 데이터 로드 및 전처리 EAE9FE260px5px타이타닉 데이터 로드 및 전처리 Python복사import seaborn as sns  데이터 로드 titanic  snsload_datasettitanic  필요한 열 선택 및 결측값 처리 titanic  titanicsurvived pclass sex age sibsp parch fare embarkeddropna  성별과 탑승한 곳 인코딩 titanicsex  titanicsexmapmale 0 female 1 titanicembarked  titanicembarkedmapC 0 Q 1 S 2  특성과 타겟 분리 X  titanicdropsurvived axis1 y  titanicsurvived  데이터 분할 X_train X_test y_train y_test  train_test_splitX y test_size02 random_state42  데이터 스케일링 scaler  StandardScaler X_train  scalerfit_transformX_train X_test  scalertransformX_test seabornload_dataset seaborn의 내장 데이터셋 로드titanic 타이타닉 데이터셋을 로드합니다titanic 타이타닉 데이터셋을 로드합니다titanic 타이타닉 데이터셋을 로드합니다pandasDataFramedropna 결측값이 있는 행 제거pandasDataFramemap 데이터 값을 다른 값으로 매핑male 0 female 1 성별을 숫자로 매핑합니다male 0 female 1 성별을 숫자로 매핑합니다male 0 female 1 성별을 숫자로 매핑합니다C 0 Q 1 S 2 탑승한 곳을 숫자로 매핑합니다C 0 Q 1 S 2 탑승한 곳을 숫자로 매핑합니다C 0 Q 1 S 2 탑승한 곳을 숫자로 매핑합니다 모델 학습모델 학습 989C9E모델 학습 EAE9FE320px5px모델 학습 Python복사 모델 생성 및 학습 model  DecisionTreeClassifierrandom_state42 modelfitX_train y_train  예측 y_pred  modelpredictX_test  평가 printfAccuracy accuracy_scorey_test y_pred printfClassification Reportclassification_reporty_test y_pred printfConfusion Matrixconfusion_matrixy_test y_pred