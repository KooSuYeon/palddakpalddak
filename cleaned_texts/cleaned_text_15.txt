15강 비지도학습  군집화모델  계층적 군집화SCC 바닥부터 시작하는 머신러닝 바닥부터 시작하는 머신러닝  4주차  15강 비지도학습  군집화모델  계층적 군집화제작 15강 비지도학습  군집화모델  계층적 군집화수업 목표비지도학습 군집화모델 중 계층적 군집화 에 대한 개념을 배우고 데이터를 이용해 실습해 봅니다목차01 계층적 군집화 개념02 계층적 군집화 실습 01 계층적 군집화 개념계층적 군집화란 무엇인지 알아봅시다1 계층적 군집화 계층적 군집화란계층적 군집화Hierarchical Clustering는 데이터포인트를 계층 구조로 그룹화하는 방법입니다 데이터 포인트를 점진적으로 병합하거나 분할하여 군집을 형성합니다계층적 군집화는 주로 두가지 방식으로 나뉩니다계층적 군집화는 주로 두가지 방식으로 나뉩니다계층적 군집화는 주로 두가지 방식으로 나뉩니다 병합 군집화 각 데이터 포인트를 개별 군집으로 시작하여 가장 가까운 군집을 반복적으로 병합합니다병합 군집화 각 데이터 포인트를 개별 군집으로 시작하여 가장 가까운 군집을 반복적으로 병합합니다병합 군집화 각 데이터 포인트를 개별 군집으로 시작하여 가장 가까운 군집을 반복적으로 병합합니다분할 군집화 모든 데이터 포인트를 하나의 군집으로 시작하여 반복적으로 가장 멀리 떨어진 군집을 분할합니다분할 군집화 모든 데이터 포인트를 하나의 군집으로 시작하여 반복적으로 가장 멀리 떨어진 군집을 분할합니다분할 군집화 모든 데이터 포인트를 하나의 군집으로 시작하여 반복적으로 가장 멀리 떨어진 군집을 분할합니다 계층적 군집화의 작동 원리거리 행렬 계산 데이터 포인트 간의 거리를 계산하여 거리 행렬을 만듭니다군집 병합분할 거리 행렬을 기반으로 가장 가까운 군집을 병합하거나 가장 멀리 떨어진 군집을 분할합니다덴드로그램 생성 군집화 과정을 시각화한 덴드로그램을 생성합니다2 병합 군집화 vs 분할 군집화 병합 군집화Agglomerative Clustering병합 군집화는 각 데이터 포인트를 개별 군집으로 시작하여 가장 가까운 군집을 반복적으로 병합합니다병합 군집화의 특징은 아래와 같습니다단순성 구현이 비교적 간단합니다계산 비용 데이터 포인트 수가 많아질수록 계산 비용이 증가합니다덴드로그램 군집화 과정을 시각화한 덴드로그램을 생성할 수 있습니다 분할 군집화Divisive Clustering분할 군집화는 모든 데이터 포인트를 하나의 군집으로 시작하여 반복적으로 가장 멀리 떨어진 군집을 분할합니다 분할 군집화의 주요 특징은 다음과 같습니다상대적으로 복잡함 병합 군집화보다 구현이 상대적으로 복잡할 수 있습니다효율성 큰 데이터셋에서 병합 군집화보다 효율적일 수 있습니다덴드로그램 군집화 과정을 시각화한 덴드로그램을 생성할 수 있습니다02 계층적 군집화 실습Kaggle 쇼핑몰 데이터를 이용하여 계층적 군집화 실습을 진행합니다1 쇼핑몰 데이터 데이터셋 다운로드Kaggle에서 Mall_Customerscsv 파일을 다운로드합니다다운로드한 파일을 작업 디렉토리에 저장합니다 데이터 로드 및 전처리쇼핑몰 데이터 로드 및 전처리 989C9E쇼핑몰 데이터 로드 및 전처리 EAE9FE265px5px쇼핑몰 데이터 로드 및 전처리 Python복사import pandas as pd import numpy as np import matplotlibpyplot as plt from sklearnpreprocessing import StandardScaler from sklearncluster import AgglomerativeClustering import scipyclusterhierarchy as sch  데이터셋 불러오기 df  pdread_csvMall_Customerscsv  데이터 확인 printdfhead  필요한 열만 선택 X  dfAge Annual Income k Spending Score 1100  데이터 정규화 scaler  StandardScaler X_scaled  scalerfit_transformX pandasread_csv CSV 파일을 로드하여 데이터프레임 생성Mall_Customerscsv 로드할 파일의 경로입니다Mall_Customerscsv 로드할 파일의 경로입니다Mall_Customerscsv 로드할 파일의 경로입니다pandasDataFramedropna 결측값이 있는 행을 제거합니다pandasDataFramemap 데이터 값을 다른 값으로 매핑합니다sklearnpreprocessingStandardScaler 데이터의 평균을 0 분산을 1로 스케일링fit_transformX_train 훈련 세트를 스케일링하고 변환합니다fit_transformX_train 훈련 세트를 스케일링하고 변환합니다fit_transformX_train 훈련 세트를 스케일링하고 변환합니다 덴드로그램 생성덴드로그램 생성 989C9E덴드로그램 생성 EAE9FE301px5px덴드로그램 생성 Python복사 덴드로그램 생성 pltfigurefigsize10 7 dendrogram  schdendrogramschlinkageX_scaled methodward plttitleDendrogram pltxlabelCustomers pltylabelEuclidean distances pltshow sklearnclusterKMeans kmeans 군집화 모델을 생성합니다n_clustersk 군집의 수를 설정합니다n_clustersk 군집의 수를 설정합니다n_clustersk 군집의 수를 설정합니다random_state42 랜덤 시드 값으로 결과의 재현성을 위해 사용됩니다random_state42 랜덤 시드 값으로 결과의 재현성을 위해 사용됩니다random_state42 랜덤 시드 값으로 결과의 재현성을 위해 사용됩니다fitdata_scaled 데이터를 학습하여 군집을 형성합니다fitdata_scaled 데이터를 학습하여 군집을 형성합니다fitdata_scaled 데이터를 학습하여 군집을 형성합니다labels_ 각 데이터 포인트가 속한 군집 레이블을 반환합니다labels_ 각 데이터 포인트가 속한 군집 레이블을 반환합니다labels_ 각 데이터 포인트가 속한 군집 레이블을 반환합니다 계층적 군집화 모델 구현덴드로그램을 통해 최적의 군집 수를 결정한 후 계층적 군집화 모델을 구현합니다계층적 군집화 모델 구현 989C9E계층적 군집화 모델 구현 EAE9FE280px5px계층적 군집화 모델 구현 Python복사 계층적 군집화 모델 생성 hc  AgglomerativeClusteringn_clusters5 metriceuclidean linkageward  모델 학습 및 예측 y_hc  hcfit_predictX_scaled  결과 시각화 pltfigurefigsize10 7 pltscatterX_scaledy_hc  0 0 X_scaledy_hc  0 1 s100 cred labelCluster 1 pltscatterX_scaledy_hc  1 0 X_scaledy_hc  1 1 s100 cblue labelCluster 2 pltscatterX_scaledy_hc  2 0 X_scaledy_hc  2 1 s100 cgreen labelCluster 3 pltscatterX_scaledy_hc  3 0 X_scaledy_hc  3 1 s100 ccyan labelCluster 4 pltscatterX_scaledy_hc  4 0 X_scaledy_hc  4 1 s100 cmagenta labelCluster 5 plttitleClusters of customers pltxlabelAge pltylabelAnnual Income k pltlegend pltshow matplotlibpyplotplot 그래프를 그립니다K inertia bx x축 y축 데이터와 그래프 스타일을 설정합니다K inertia bx x축 y축 데이터와 그래프 스타일을 설정합니다K inertia bx x축 y축 데이터와 그래프 스타일을 설정합니다seabornscatterplot 산점도를 그립니다xdataAge x축 데이터xdataAge x축 데이터xdataAge x축 데이터ydataAnnual Income k y축 데이터ydataAnnual Income k y축 데이터ydataAnnual Income k y축 데이터huedataCluster 색상에 따라 군집을 구분합니다huedataCluster 색상에 따라 군집을 구분합니다huedataCluster 색상에 따라 군집을 구분합니다paletteviridis 색상 팔레트를 설정합니다paletteviridis 색상 팔레트를 설정합니다paletteviridis 색상 팔레트를 설정합니다 모델 평가모델 평가 989C9E모델 평가 EAE9FE318px5px모델 평가 Python복사from sklearnmetrics import silhouette_score  실루엣 점수 계산 silhouette_avg  silhouette_scoreX_scaled y_hc printfSilhouette Score silhouette_avg