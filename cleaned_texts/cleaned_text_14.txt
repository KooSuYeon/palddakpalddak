14강 비지도학습  군집화모델  kmeans clusteringSCC 바닥부터 시작하는 머신러닝 바닥부터 시작하는 머신러닝  4주차  14강 비지도학습  군집화모델  kmeans clustering제작 14강 비지도학습  군집화모델  kmeans clustering수업 목표비지도학습 군집화모델 중 kmeans clustering 에 대한 개념을 배우고 데이터를 이용해 실습해 봅니다목차01 kmeans clustering 개념02 kmeans clustering 실습 01 kmeans clustering 개념kmeans clustering이 무엇인지 알아봅시다1 kmeans clustering kmeans clustering 이란ALT 알고리즘의 단계초기화 k개의 군집 중심을 랜덤하게 설정합니다할당 단계 각 데이터 포인트를 가장 가까운 군집 중심에 할당합니다업데이트 단계 각 군집의 중심을 해당 군집에 속한 데이터 포인트들의 평균으로 업데이트합니다반복 할당 단계와 업데이트 단계를 군집 중심이 더 이상 변화하지 않을 때까지 반복합니다 거리 측정 방법kmeans 알고리즘은 주로 유클리드 거리Euclidean Distance를 사용하여 데이터 포인트와 군집 중심 간의 거리를 계산합니다dpqi1npiqi2dp q  _i1n p_i  q_i2dpqi1npiqi2엘보우 방법최적의 k를 선택하는 데 사용됩니다k를 증가시키면서 각 k에 대한 군집의 응집도또는 관성 Inertia를 계산하고 이를 그래프로 나타내어 그래프에서 응집도가 급격히 감소하는 지점을 찾습니다ALT02 kmeans clustering 실습Kaggle 쇼핑몰 데이터를 이용하여 Kmeans clustering 실습을 진행합니다1 쇼핑몰 데이터 데이터셋 다운로드Kaggle에서 Mall_Customerscsv 파일을 다운로드합니다다운로드한 파일을 작업 디렉토리에 저장합니다 데이터 로드 및 전처리유방암 데이터 로드 및 전처리 989C9E유방암 데이터 로드 및 전처리 EAE9FE265px5px유방암 데이터 로드 및 전처리 Python복사import numpy as np import pandas as pd from sklearnpreprocessing import StandardScaler from sklearncluster import KMeans import matplotlibpyplot as plt import seaborn as sns  데이터 로드 data  pdread_csvMall_Customerscsv  필요한 열 선택 및 결측값 처리 data  dataAge Annual Income k Spending Score 1100  데이터 스케일링 scaler  StandardScaler data_scaled  scalerfit_transformdata pandasread_csv CSV 파일을 로드하여 데이터프레임 생성Mall_Customerscsv 로드할 파일의 경로입니다Mall_Customerscsv 로드할 파일의 경로입니다Mall_Customerscsv 로드할 파일의 경로입니다pandasDataFramedropna 결측값이 있는 행을 제거합니다pandasDataFramemap 데이터 값을 다른 값으로 매핑합니다sklearnpreprocessingStandardScaler 데이터의 평균을 0 분산을 1로 스케일링fit_transformX_train 훈련 세트를 스케일링하고 변환합니다fit_transformX_train 훈련 세트를 스케일링하고 변환합니다fit_transformX_train 훈련 세트를 스케일링하고 변환합니다 모델 학습 및 군집화모델 학습 및 군집화 989C9E모델 학습 및 군집화 EAE9FE292px5px모델 학습 및 군집화 Python복사 최적의 k 찾기 엘보우 방법 inertia   K  range1 11 for k in K kmeans  KMeansn_clustersk random_state42 kmeansfitdata_scaled inertiaappendkmeansinertia_  엘보우 그래프 그리기 pltfigurefigsize10 8 pltplotK inertia bx pltxlabelk pltylabelInertia plttitleElbow Method For Optimal k pltshow  k5로 모델 생성 및 학습 kmeans  KMeansn_clusters5 random_state42 kmeansfitdata_scaled  군집 결과 할당 dataCluster  kmeanslabels_ sklearnclusterKMeans kmeans 군집화 모델을 생성합니다n_clustersk 군집의 수를 설정합니다n_clustersk 군집의 수를 설정합니다n_clustersk 군집의 수를 설정합니다random_state42 랜덤 시드 값으로 결과의 재현성을 위해 사용됩니다random_state42 랜덤 시드 값으로 결과의 재현성을 위해 사용됩니다random_state42 랜덤 시드 값으로 결과의 재현성을 위해 사용됩니다fitdata_scaled 데이터를 학습하여 군집을 형성합니다fitdata_scaled 데이터를 학습하여 군집을 형성합니다fitdata_scaled 데이터를 학습하여 군집을 형성합니다labels_ 각 데이터 포인트가 속한 군집 레이블을 반환합니다labels_ 각 데이터 포인트가 속한 군집 레이블을 반환합니다labels_ 각 데이터 포인트가 속한 군집 레이블을 반환합니다 군집 시각화군집 시각화 989C9E군집 시각화 EAE9FE314px5px군집 시각화 Python복사 2차원으로 군집 시각화 연령 vs 소득 pltfigurefigsize10 8 snsscatterplotxdataAge ydataAnnual Income k huedataCluster paletteviridis plttitleClusters of customers Age vs Annual Income pltshow  2차원으로 군집 시각화 소득 vs 지출 점수 pltfigurefigsize10 8 snsscatterplotxdataAnnual Income k ydataSpending Score 1100 huedataCluster paletteviridis plttitleClusters of customers Annual Income vs Spending Score pltshow matplotlibpyplotplot 그래프를 그립니다K inertia bx x축 y축 데이터와 그래프 스타일을 설정합니다K inertia bx x축 y축 데이터와 그래프 스타일을 설정합니다K inertia bx x축 y축 데이터와 그래프 스타일을 설정합니다seabornscatterplot 산점도를 그립니다xdataAge x축 데이터xdataAge x축 데이터xdataAge x축 데이터ydataAnnual Income k y축 데이터ydataAnnual Income k y축 데이터ydataAnnual Income k y축 데이터huedataCluster 색상에 따라 군집을 구분합니다huedataCluster 색상에 따라 군집을 구분합니다huedataCluster 색상에 따라 군집을 구분합니다paletteviridis 색상 팔레트를 설정합니다paletteviridis 색상 팔레트를 설정합니다paletteviridis 색상 팔레트를 설정합니다