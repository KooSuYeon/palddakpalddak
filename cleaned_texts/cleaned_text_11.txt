11강 지도학습  분류모델  KNNSCC 바닥부터 시작하는 머신러닝 바닥부터 시작하는 머신러닝  3주차 11강 지도학습  분류모델  KNN제작 11강 지도학습  분류모델  KNN수업 목표KNNKNearest Neighbors에 대한 개념을 배우고 데이터를 이용해 실습해 봅니다목차01 KNN 개념02 KNN 실습 01 KNN 개념KNNK 최근접 이웃  KNearest Neighbors이 무엇인지 알아봅시다1 KNN KNN이란KNN 알고리즘은 분류와 회귀 분석에 사용되는 비모수적 방법 입니다새로운 데이터 포인트를 기존 데이터 포인트 중 가장 가까운 K개의 이웃과 비교하여 분류합니다데이터 포인트의 특성을 기준으로 거리 계산을 통해 가장 가까운 이웃을 찾습니다ALT거리 측정  KNN 알고리즘에서 가장 중요한 요소입니다 일반적으로 유클리드 거리가 사용됩니다거리 측정  KNN 알고리즘에서 가장 중요한 요소입니다 일반적으로 유클리드 거리가 사용됩니다거리 측정  KNN 알고리즘에서 가장 중요한 요소입니다 일반적으로 유클리드 거리가 사용됩니다 K값  K는 결정 경계의 매끄러움에 영향을 미치는 하이퍼파라미터입니다 K값  K는 결정 경계의 매끄러움에 영향을 미치는 하이퍼파라미터입니다 K값  K는 결정 경계의 매끄러움에 영향을 미치는 하이퍼파라미터입니다  작은 K값은 더 노이즈에 민감하고큰 K값은 더 매끄러운 경계를 만듭니다 작은 K값은 더 노이즈에 민감하고큰 K값은 더 매끄러운 경계를 만듭니다 작은 K값은 더 노이즈에 민감하고큰 K값은 더 매끄러운 경계를 만듭니다 다수결 투표  K개의 가장 가까운 이웃의 클래스중 가장 빈번한 클래스로 새로운 데이터 포인트를 분류합니다다수결 투표  K개의 가장 가까운 이웃의 클래스중 가장 빈번한 클래스로 새로운 데이터 포인트를 분류합니다다수결 투표  K개의 가장 가까운 이웃의 클래스중 가장 빈번한 클래스로 새로운 데이터 포인트를 분류합니다 KNN의 목적KNN의 목표는 학습 데이터를 기반으로 새로운 데이터 포인트의 클래스를 예측하는 것입니다이는 분류 문제에서 주로 사용되며 다양한 응용 분야에 활용될 수 있습니다02 KNN 실습Scikitlearn의 유방암데이터와 Seaborn의 타이타닉 데이터로 KNN 실습을 진행합니다1 유방암 데이터 데이터 로드 및 전처리유방암 데이터 로드 및 전처리 989C9E유방암 데이터 로드 및 전처리 EAE9FE265px5px유방암 데이터 로드 및 전처리 Python복사import numpy as np import pandas as pd from sklearndatasets import load_breast_cancer from sklearnmodel_selection import train_test_split from sklearnpreprocessing import StandardScaler  데이터 로드 data  load_breast_cancer X  datadata y  datatarget  데이터 분할 X_train X_test y_train y_test  train_test_splitX y test_size02 random_state42  데이터 스케일링 scaler  StandardScaler X_train  scalerfit_transformX_train X_test  scalertransformX_test sklearndatasetsload_breast_cancer 유방암 데이터셋 로드return_X_yFalse 데이터와 타겟을 함께 반환할지 여부 기본값은 False입니다return_X_yFalse 데이터와 타겟을 함께 반환할지 여부 기본값은 False입니다return_X_yFalse 데이터와 타겟을 함께 반환할지 여부 기본값은 False입니다sklearnmodel_selectiontrain_test_split 데이터를 훈련 세트 테스트 세트로 분할test_size02 테스트 세트의 비율을 02로 설정합니다test_size02 테스트 세트의 비율을 02로 설정합니다test_size02 테스트 세트의 비율을 02로 설정합니다random_state42 랜덤 시드 값으로 데이터 분할의 재현성을 위해 사용됩니다random_state42 랜덤 시드 값으로 데이터 분할의 재현성을 위해 사용됩니다random_state42 랜덤 시드 값으로 데이터 분할의 재현성을 위해 사용됩니다sklearnpreprocessingStandardScaler 데이터의 평균을 0 분산을 1로 스케일링fit_transformX_train 훈련 세트를 스케일링하고 변환합니다fit_transformX_train 훈련 세트를 스케일링하고 변환합니다fit_transformX_train 훈련 세트를 스케일링하고 변환합니다transformX_test 테스트 세트를 변환합니다transformX_test 테스트 세트를 변환합니다transformX_test 테스트 세트를 변환합니다 모델 학습모델 학습 989C9E모델 학습 EAE9FE320px5px모델 학습 Python복사from sklearnneighbors import KNeighborsClassifier from sklearnmetrics import accuracy_score classification_report confusion_matrix  모델 생성 및 학습 model  KNeighborsClassifiern_neighbors5 modelfitX_train y_train  예측 y_pred  modelpredictX_test  평가 printfAccuracy accuracy_scorey_test y_pred printfClassification Reportclassification_reporty_test y_pred printfConfusion Matrixconfusion_matrixy_test y_pred sklearnneighborsKNeighborsClassifier KNN 모델 생성n_neighbors5 사용할 이웃의 수K를 설정합니다n_neighbors5 사용할 이웃의 수K를 설정합니다n_neighbors5 사용할 이웃의 수K를 설정합니다fitX_train y_train 모델을 훈련 세트에 맞추어 학습시킵니다fitX_train y_train 모델을 훈련 세트에 맞추어 학습시킵니다fitX_train y_train 모델을 훈련 세트에 맞추어 학습시킵니다predictX_test 테스트 세트에 대해 예측을 수행합니다predictX_test 테스트 세트에 대해 예측을 수행합니다predictX_test 테스트 세트에 대해 예측을 수행합니다sklearnmetricsaccuracy_score 정확도 계산accuracy_scorey_test y_pred 실제 값과 예측 값을 비교하여 정확도를 반환합니다accuracy_scorey_test y_pred 실제 값과 예측 값을 비교하여 정확도를 반환합니다accuracy_scorey_test y_pred 실제 값과 예측 값을 비교하여 정확도를 반환합니다sklearnmetricsclassification_report 분류 보고서 생성classification_reporty_test y_pred 정확도 정밀도 재현율 등의 메트릭을 포함한 보고서를 출력합니다classification_reporty_test y_pred 정확도 정밀도 재현율 등의 메트릭을 포함한 보고서를 출력합니다classification_reporty_test y_pred 정확도 정밀도 재현율 등의 메트릭을 포함한 보고서를 출력합니다sklearnmetricsconfusion_matrix 혼동 행렬 생성confusion_matrixy_test y_pred 실제 값과 예측 값의 혼동 행렬을 반환합니다confusion_matrixy_test y_pred 실제 값과 예측 값의 혼동 행렬을 반환합니다confusion_matrixy_test y_pred 실제 값과 예측 값의 혼동 행렬을 반환합니다2 타이타닉 데이터 데이터 로드 및 전처리타이타닉 데이터 로드 및 전처리 989C9E타이타닉 데이터 로드 및 전처리 EAE9FE260px5px타이타닉 데이터 로드 및 전처리 Python복사import seaborn as sns  데이터 로드 titanic  snsload_datasettitanic  필요한 열 선택 및 결측값 처리 titanic  titanicsurvived pclass sex age sibsp parch fare embarkeddropna  성별과 탑승한 곳 인코딩 titanicsex  titanicsexmapmale 0 female 1 titanicembarked  titanicembarkedmapC 0 Q 1 S 2  특성과 타겟 분리 X  titanicdropsurvived axis1 y  titanicsurvived  데이터 분할 X_train X_test y_train y_test  train_test_splitX y test_size02 random_state42  데이터 스케일링 scaler  StandardScaler X_train  scalerfit_transformX_train X_test  scalertransformX_test seabornload_dataset seaborn의 내장 데이터셋 로드titanic 타이타닉 데이터셋을 로드합니다titanic 타이타닉 데이터셋을 로드합니다titanic 타이타닉 데이터셋을 로드합니다pandasDataFramedropna 결측값이 있는 행 제거pandasDataFramemap 데이터 값을 다른 값으로 매핑male 0 female 1 성별을 숫자로 매핑합니다male 0 female 1 성별을 숫자로 매핑합니다male 0 female 1 성별을 숫자로 매핑합니다C 0 Q 1 S 2 탑승한 곳을 숫자로 매핑합니다C 0 Q 1 S 2 탑승한 곳을 숫자로 매핑합니다C 0 Q 1 S 2 탑승한 곳을 숫자로 매핑합니다 모델 학습모델 학습 989C9E모델 학습 EAE9FE320px5px모델 학습 Python복사 모델 생성 및 학습 model  KNeighborsClassifiern_neighbors5 modelfitX_train y_train  예측 y_pred  modelpredictX_test  평가 printfAccuracy accuracy_scorey_test y_pred printfClassification Reportclassification_reporty_test y_pred printfConfusion Matrixconfusion_matrixy_test y_pred